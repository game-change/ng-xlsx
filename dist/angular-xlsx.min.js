angular.module("ngXlsx",[]).factory("ngXlsx",function(){function a(){return this instanceof a?(this.SheetNames=[],void(this.Sheets={})):new a}function b(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function c(a,c,d){for(var e=0;e<c.length;e++){e>d.e.c&&(d.e.c=e);var f={v:c[e]};if(null!==f.v){"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Function?f.v(f,{datenum:b}):f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=b(f.v)):f.t="s";var g=XLSX.utils.encode_cell({c:e,r:d.e.r});a[g]=f}}d.e.r++}function d(b){var d={bookType:"xlsx",bookSST:!1,type:"binary"},e=new a;b.forEach(function(a){var b={},d=a.columnDefs,f={s:{c:0,r:0},e:{c:d.length-1,r:0}},g=[];d.forEach(function(a){g.push(a.displayName)}),c(b,g,f),a.data.forEach(function(a){var e=[];d.forEach(function(b){e.push(a[b.field])}),c(b,e,f)}),f.e.r--,b["!ref"]=XLSX.utils.encode_range(f),e.SheetNames.push(a.sheetName),e.Sheets[a.sheetName]=b});var f=XLSX.write(e,d);return f}function e(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}function f(a){var b=d(a);return new Blob([e(b)],{type:"application/octet-stream"})}return{writeXlsx:d,getBlob:f}});